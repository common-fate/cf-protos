syntax = "proto3";

package glog.v1alpha1;

import "google/protobuf/timestamp.proto";
import "validate/validate.proto";

// GlogService is API to glog, the Granted transparency log.
service GlogService {
  // Store a payload in the transparency log
  rpc Store(StoreRequest) returns (StoreResponse);
}

message UpdateConfigPayload {
  bytes config_sha256 = 1 [(validate.rules).bytes.len = 32];
}

message Envelope {
  TimestampedPayload payload = 1;
  // our ECDSA256 signatures are 64 bytes long
  bytes signature = 2 [(validate.rules).bytes.len = 64];
}

message TimestampedPayload {
  oneof contents {
    UpdateConfigPayload update_config = 1;
  }
  google.protobuf.Timestamp timestamp = 2;
}

message StoreRequest {
  Envelope envelope = 1;
}

message StoreResponse {}